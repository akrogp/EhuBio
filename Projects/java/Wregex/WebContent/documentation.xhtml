<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:body>	
	<ui:composition template="./WEB-INF/templates/template.xhtml">
		<ui:define name="title">Documentation</ui:define>
		<ui:define name="htmlhead">
			<meta name="description" content="Wregex documentation. A novel approach for amino acid motif searching combining a regular expression with a Position-Specific Scoring Matrix (PSSM)."/>
		</ui:define>
		<ui:define name="content">
		<h:outputStylesheet name="css/documentation.css"/>
		<h:form id="docForm">
		
		<h3>Table of Contents</h3>
		<ul style="margin: 20px">
		<li><a href="#overview">Overview</a></li>
		<li><a href="#compat">Browser compatibility</a></li>
		<li><a href="#cases">Examples</a></li>		
		<li><a href="#search">Basic Search</a></li>		
		<li><a href="#custom">Advanced Search</a></li>
		<li><a href="#training">Building a Custom PSSM</a></li>
		<li><a href="#local">Running Wregex on your Local PC</a></li>
		</ul>		
		
		<h3 class=".ui-state-default"><a id="overview">Overview</a></h3>		
		<p>Wregex (weighted regular expression) offers a new approach for amino acid motif searching. Wregex
		combines a regular expression with an optional Position-Specific Scoring Matrix (PSSM). The regular
		expression is used to obtain a candidate list matching the desired conditions, and the PSSM
		is used for computing a score that can be used to select the most promising of those candidates.</p>
		<p>Wregex supports all motifs in <a href="http://elm.eu.org/">ELM</a> as regular expressions, and
		a PSSM has already been built for some of them. In the case your motif is not included in the list
		or a PSSM is not available, you can easily build your own as detailed later. Then you can also notify us
		your motif definition and we will be happy to include it in the default motif list used in the basic search.</p>
		
		<h3><a id="compat">Browser compatibility</a></h3>
		<p:dataTable value="#{homeView.compat}" var="test" tableStyle="width:auto">
			<p:column headerText="OS">#{test.os}</p:column>
			<p:column headerText="Version">#{test.osVersion}</p:column>
			<p:columns value="#{homeView.browsers}" var="browser" headerText="#{browser}">
				#{test.browser.get(browser)}
			</p:columns>
		</p:dataTable>
		
		<h3><a id="cases">Examples</a></h3>		
		<p>To facilitate familiarity for novice users with the search form and the types of results obtained, the following presets are provided as example case studies:</p>		
		<p:dataTable id="casesTable" value="#{databasesBean.caseStudies}" var="case" rowIndexVar="idx" tableStyle="width:auto">
			<p:column headerText="Case">#{case.name}</p:column>
			<p:column headerText="Description">#{case.description}</p:column>
			<p:column>
				<p:commandButton action="#{homeView.navigateCase(case.value)}" value="Load Case Study ##{idx+1}" styleClass="caseButton"/>
			</p:column>
		</p:dataTable>
		
		<h3><a id="search">Basic Search</a></h3>
		<h:graphicImage name="tutorial/BasicSearch.png" style="float:right"/>		
		<p>The basic search consists on searching a target protein dataset for one or several predefined short linear motifs (SLiMs):</p>
		<ul>
			<li>First of all, the main motif of interest must be selected from the dropdown list. This list is divided into a first part
			containing entries specific of Wregex for which both a regular expression and a PSSM are available, and a second part consisting
			on <a href="http://elm.eu.org/">ELM</a> entries without a PSSM. Once a motif is selected, a second dropdown list is shown to the
			right allowing the user to select a specific motif configuration (different regular expression and/or PSSM) in case there are
			several available.</li>
			<li>Next, a target protein dataset must be specified. This can be done in multiple ways: by selecting a predefined dataset available
			in the target dropdown list provided by Wregex, by providing a Gene Ontology (GO) term, by entering a list of
			protein accessions or gene names, or by uploading a custom fasta file.</li>
			<li>After completing the two steps above, a <i>Search!</i> button will be finally shown. Clicking
			this button starts a new search and a list of candidates will be shown when finished (if there is any match).</li>			
		</ul>
		<p>Additionally, external database <i>Connections</i> can be enabled for conducting more specific searches:</p>
		<ul>
			<li>COSMIC: for each candidate motif above searches COSMIC missense mutations and ranks the results according to each mutation
			impact and recurrence.</li>
			<li>PhosphoSitePlus/dbPTM: allows selecting the desired PTM types and for each candidate motif above searches the selected PTMs
			and ranks the results according to the number of PTMs present.</li>
		</ul>
		<p>The default Wregex behaviour can be customized by changing the <i>Options</i> section:</p>
		<ul>
			<li>The <i>Grouping</i> checkbox allows to configure whether overlapping candidates should be considered as
			a single entry or separated into multiple entries. An overlap occurs when there are several combinations
			that match the regular expression in the same region of the protein.</li>
			<li>The <i>Filter similar</i> checkbox is useful when the user is interested only in the motif sequence. If enabled,
			only the first result for the same matched sequence is shown.</li>
			<li>The <i>Filter without connections</i> checkbox keeps only the results with values for any of the external connections
			selected.</li>
			<li>The score <i>Threshold</i> spinner keeps only main motif matches with a PSSM score equal or larger than the value specified.</li>
			<li>The number of <i>Flanking</i> amino acids spinner shows additional amino acids at both sides of each match.</li>
		</ul>		
		<p>Finally, the results are displayed as follows:</p>
		<ul><h:graphicImage name="tutorial/Download.png" style="float:right"/>
			<li>First of all, the total number of results obtained is shown followed by three buttons that allow downloading
			these results into a local file in the user's computer in the following formats respectively:
				<ul>
					<li>Comma Separated Values (CSV): useful for further analysis using any spreadsheet or statistical analysis software.</li>
					<li>Clustal ALN file: can be used to display the alignments of the results using the capturing groups indicated between
					parenthesis () in the regular expression.</li>
					<li>Fasta: amino acid sequences that can also be used for training a PSSM as explained later on.</li>
				</ul>
			</li>
			<li>These results are also displayed on a table with the following columns among others:
				<ul><h:graphicImage name="tutorial/Results.png" style="float:right"/>
					<li>Protein accession/entry from the fasta header.</li>
					<li>Starting and ending positions of the candidate motif within the protein sequence.</li>
					<li>Candidate motif sequence with the regular expression groups indicated between dashes (-).</li>
					<li>Number of combinations grouped in the same entry (overlapping positions).</li>
					<li>Wregex score (ranging from 0 to 100).</li>
					<li>If there are motif annotations with scores in the input fasta sequences, their score is also displayed as the assay score.</li>
					<li>Percentage of motif sequence within a disordered region annotated in UniProt.</li>
					<li>Number of features within the motif region annotated in UniProt. By passing the mouse over this number, detailed results are shown.</li>
					<li>If enabled, COSMIC mutated sequences, the mutation impact and recurrence.</li>
					<li>If enabled, PSP/dbPTM modifications within the candidate motif.</li>
				</ul>
			</li>
		</ul>
		
		<h3><a id="custom">Advanced Search</a></h3>
		<h:graphicImage name="tutorial/Custom.png" style="float:right"/>
		<p>In the motif dropdown list "Custom" can be selected to let the user enter a custom motif, consisting on
		a custom regular expression and an optional custom PSSM.</p>
		<p>The syntax for the regular expression is the one used by the <a href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html" target="_blank">
		Pattern Java class</a>. For instance <tt>[LIMA].{2,3}[LIVMF]</tt> means any of leucine (L), isoleucine (I), methionine (M)
		or alanine (A) followed by 2 or 3 ({2,3}) occurrences of any (.) amino acid and then followed by any of
		leucine (L), isoleucine (I), valine (V), methionine (M) or phenylalanine (F).</p>
		<p>This regular expression can be complemented with a Position-Specific Scoring Matrix (PSSM) so that any
		match of the regular expression in the input fasta file will be assigned a score. In order to use a PSSM, the
		different positions must be indicated within the regular expression by using <a href="http://docs.oracle.com/javase/tutorial/essential/regex/groups.html" target="_blank">
		capturing groups</a>. Using the previous example, the following regular expression <tt>([LIMA])(.{2,3})([LIVMF])</tt>
		will match the same sequences than before but it will also define 3 positions: the first one consisting on
		the first hydrophobic amino acid, the second one on the 2-3 amino acid separation, and the third one on the
		final hydrophobic amino acid. Then, a custom PSSM indicating a weight for every amino acid in each of the
		three positions can be provided for computing a match score.</p>
		
		<h3><a id="training">Building a Custom PSSM</a></h3>		
		<p>A training web page is provided for allowing the user to build a custom PSSM. Basically this just requires
		two steps: 1) define a custom regular expression with capturing groups to indicate the PSSM positions, and 2)
		provide an input fasta file with the training sequences.</p>
		<h:graphicImage name="tutorial/InputMotifs2.png" style="float:right"/><h:graphicImage name="tutorial/InputMotifs1.png" style="float:right"/>
		<p>The regular expression must be indicated in the corresponding input text box of the training page. Then
		clicking in the input motifs button will open a new input motifs page. In this input motifs page an input fasta file with
		the training sequences must be selected. Then a table will be displayed when the user can assign a weight to
		each of the matches, and even re-define the position of the match if it is a part of a larger motif.
		The "Matched" column displays the number of matches of the custom regex within the motif position range defined.
		This number will be used to divide the motif weight between the different matches when building the PSSM.</p>
		<p>The resulting training motif list can be downloaded as a fasta file. This file will have annotations of
		the motif positions and weights that will be recovered if the same file is used later for further training.</p>
		<h:graphicImage name="tutorial/Training.png" style="float:right"/>
		<p>Once the input motif list has been completed, clicking again in the training page will show the list of
		training matches. Each of these matches will display the weight of the matched input motif, and the score resulting
		from dividing this weight between the number of matches for that motif ("!"). If any of the matches is known to be
		not valid, it can be disabled just by clicking the recycle bin icon in the "Action" column. This will display
		a not-valid icon in the corresponding row, and decrease the number of matches for the corresponding motif.
		This will also update the divided weight since the original input motif weight will be distributed between the
		remaining matches for that motif. Any disabled match can be re-enabled at any time just by clicking the recycle
		icon in the "Action" column.</p>
		<p>Once the user finishes validating the list of training matches, the resulting PSSM can be downloaded to
		a local file. This file can then be selected together with the custom regex for being used in the custom
		search option described above.</p>
		<p>If you define a custom regex and custom PSSM that you think they could be of interest for others,
		please send then to us indicating also references to any paper from you or others supporting that evidence.
		We will be happy to include that custom motif in the dropdown list to share it through the basic search.</p>
		
		<h3><a id="local">Running Wregex on your Local PC</a></h3>
		<p>In case you need intensive Wregex execution, you could opt to run it locally on your PC. This can be
		done by running it on a local Java EE application server, or creating a custom Java front-end
		using the provided Wregex Java class. Both the *.war binary file and the Java code can be accessed from the
		Downloads page.</p>
		<p>Wregex execution at #{homeView.webUrl} has some constraints, i.e. input fasta file size and execution time
		in order to avoid denial of service to other users. This constrains can be avoided when running Wregex
		locally by changing the default limits at <tt>WEB-INF/web.xml</tt>. Please take into account that Wregex uses
		a predefined set of databases which must be present in the system. You can modify (add/delete) these databases
		by editing the <tt>resources/data/databases.xml</tt> file.</p>				

		<p:blockUI block="docForm" trigger="@(.caseButton)">
			Loading...
		</p:blockUI>
		</h:form>		
		</ui:define>
	</ui:composition>
</h:body>
</html>
